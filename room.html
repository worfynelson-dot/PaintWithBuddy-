<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PaintWithBuddy - Room ðŸŽ¨</title>
  <link rel="stylesheet" href="/css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="room-body">

  <!-- Top Bar -->
  <div class="top-bar">
    <div class="top-left">
      <a href="/" class="back-btn" title="Leave Room">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
      </a>
      <div class="room-brand">
        <span class="brand-icon">ðŸŽ¨</span>
        <span class="brand-text">PaintWithBuddy</span>
      </div>
    </div>
    <div class="top-center">
      <div class="room-code-display">
        <span class="room-label">Room:</span>
        <span id="roomCodeDisplay" class="room-code-text"></span>
        <button id="copyCodeBtn" class="copy-btn" title="Copy room code">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="top-right">
      <div id="usersOnline" class="users-online">
        <span class="online-dot"></span>
        <span id="userCount">0</span> online
      </div>
      <button id="voiceToggle" class="voice-btn" title="Toggle voice chat">
        <svg id="micIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/>
          <path d="M19 10v2a7 7 0 01-14 0v-2"/>
          <line x1="12" y1="19" x2="12" y2="23"/>
          <line x1="8" y1="23" x2="16" y2="23"/>
        </svg>
        <svg id="micOffIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none">
          <line x1="1" y1="1" x2="23" y2="23"/>
          <path d="M9 9v3a3 3 0 005.12 2.12M15 9.34V4a3 3 0 00-5.94-.6"/>
          <path d="M17 16.95A7 7 0 015 12v-2m14 0v2c0 .74-.12 1.46-.33 2.13"/>
          <line x1="12" y1="19" x2="12" y2="23"/>
          <line x1="8" y1="23" x2="16" y2="23"/>
        </svg>
      </button>
      <button id="chatToggle" class="chat-toggle-btn" title="Toggle chat">
        ðŸ’¬
        <span id="chatBadge" class="chat-badge" style="display:none">0</span>
      </button>
    </div>
  </div>

  <!-- Main Layout -->
  <div class="room-layout">

    <!-- Left Toolbar -->
    <div class="toolbar-left">
      <div class="tool-section">
        <label class="tool-label">Tools</label>
        <div class="tool-grid">
          <button class="tool-btn active" data-tool="brush" title="Brush">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 19l7-7 3 3-7 7-3-3z"/>
              <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
              <path d="M2 2l7.586 7.586"/>
              <circle cx="11" cy="11" r="2"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="pencil" title="Pencil">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="marker" title="Marker">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 20h4L19.5 8.5a2.828 2.828 0 00-4-4L4 16v4z"/>
              <path d="M13.5 6.5l4 4"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="spray" title="Spray Can">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="6" y="10" width="10" height="12" rx="2"/>
              <path d="M9 10V7a2 2 0 012-2h0a2 2 0 012 2v3"/>
              <circle cx="18" cy="4" r="1"/>
              <circle cx="20" cy="7" r="1"/>
              <circle cx="21" cy="3" r="1"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="watercolor" title="Watercolor">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2.69l5.66 5.66a8 8 0 11-11.31 0z"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="crayon" title="Crayon">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="8" y="2" width="8" height="20" rx="1" transform="rotate(-15 12 12)"/>
              <path d="M10.5 5l3-1"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="calligraphy" title="Calligraphy">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M6 20Q2 12 10 4c4-2 8 2 6 8-2 4-6 4-6 8z"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="eraser" title="Eraser">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 20H7L3 16a1.5 1.5 0 010-2L14.5 2.5a1.5 1.5 0 012 0L21 7a1.5 1.5 0 010 2L11 19"/>
              <path d="M6 14l4 4"/>
            </svg>
          </button>
          <button class="tool-btn" data-tool="fill" title="Fill Bucket">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M2 22l1-1h3l9-9"/>
              <path d="M3 21l9-9"/>
              <circle cx="7.5" cy="15.5" r="4"/>
              <path d="M16 4l4 4-7 7"/>
              <path d="M19 15c1 1 2 3 0 5s-4 0-5 0"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="tool-section">
        <label class="tool-label">Brush Size</label>
        <div class="size-control">
          <input type="range" id="brushSize" min="1" max="80" value="5" class="size-slider">
          <div id="sizePreview" class="size-preview">
            <div id="sizePreviewDot" class="size-preview-dot"></div>
          </div>
          <span id="sizeValue" class="size-value">5px</span>
        </div>
      </div>

      <div class="tool-section">
        <label class="tool-label">Opacity</label>
        <div class="size-control">
          <input type="range" id="brushOpacity" min="10" max="100" value="100" class="size-slider opacity-slider">
          <span id="opacityValue" class="size-value">100%</span>
        </div>
      </div>

      <div class="tool-section">
        <label class="tool-label">Colors</label>
        <div class="color-palette" id="colorPalette"></div>
        <div class="custom-color-row">
          <input type="color" id="customColor" value="#000000" class="custom-color-input">
          <span class="custom-label">Custom</span>
        </div>
      </div>

      <div class="tool-section actions-section">
        <button id="undoBtn" class="action-btn" title="Undo">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 10h10a5 5 0 010 10H9M3 10l4-4M3 10l4 4"/>
          </svg>
          Undo
        </button>
        <button id="clearBtn" class="action-btn danger" title="Clear Canvas">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3,6 5,6 21,6"/>
            <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
          </svg>
          Clear
        </button>
        <button id="saveBtn" class="action-btn" title="Save Canvas">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
            <polyline points="7,10 12,15 17,10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Save
        </button>
      </div>
    </div>

    <!-- Canvas Area -->
    <div class="canvas-wrapper" id="canvasWrapper">
      <canvas id="mainCanvas"></canvas>
      <div id="cursorsLayer" class="cursors-layer"></div>
    </div>

    <!-- Chat Sidebar -->
    <div id="chatSidebar" class="chat-sidebar hidden">
      <div class="chat-header">
        <h3>ðŸ’¬ Chat</h3>
        <button id="closeChatBtn" class="close-chat-btn">âœ•</button>
      </div>
      <div class="users-list" id="usersList"></div>
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input-area">
        <input type="text" id="chatInput" placeholder="Type a message..." maxlength="200" autocomplete="off">
        <button id="sendChatBtn" class="send-btn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="22" y1="2" x2="11" y2="13"/>
            <polygon points="22,2 15,22 11,13 2,9"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/canvas.js"></script>
  <script src="/js/voice.js"></script>
  <script src="/js/room.js"></script>
</body>
</html>